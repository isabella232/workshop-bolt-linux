#name: boltshop::build_webserver
description: Deploys an Apache webserver with some base configuration.

parameters:
  targets:
    type: TargetSpec
    description: The targets to configure
  port:
    type: Integer
    description: Port number to access Apache webserver

steps:
  #- command: "mv /etc/httpd/conf.d/welcome.conf /etc/httpd/conf.d/welcome.conf_backup"
  #  description: "Initialising custom Apache webserver"
  #  targets: $targets
  #- upload: boltshop/mywebsite
   # description: "Uploading initial website content to the appropriate folder."
   # destination: "/var" #test this again just on /var/, try a new node
   # targets: $targets
  - name: apacheconfig
    targets: $targets
    resources:
      - class: apache
        parameters:
          default_vhost: false
          docroot: "/var/mywebsite"
      - class: apache::vhost
  - task: service
    description: "Restarting httpd service"
    targets: "$targets"
    parameters:
      name: httpd
      action: restart
    